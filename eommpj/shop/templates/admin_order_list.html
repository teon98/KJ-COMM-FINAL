<h1>주문 관리</h1>

<!-- 필터링 폼 -->
<form method="GET" action="">
    <label for="user">사용자 이름:</label>
    <input type="text" id="user" name="user" value="{{ request.GET.user }}">

    <label for="cart_group_id">장바구니 그룹 ID:</label>
    <input type="text" id="cart_group_id" name="cart_group_id" value="{{ request.GET.cart_group_id }}">

    <label for="date">주문 날짜:</label>
    <input type="date" id="date" name="date" value="{{ request.GET.date }}">

    <button type="submit">필터</button>
</form>

<!-- 주문 목록 -->
<table>
    <thead>
        <tr>
            <th>주문 ID</th>
            <th>사용자</th>
            <th>상품</th>
            <th>수량</th>
            <th>총액</th>
            <th>결제 방식</th>
            <th>결제 상태</th>
            <th>주문 날짜</th>
            <th>상태 업데이트</th>
        </tr>
    </thead>
    <tbody>
        {% for order in orders %}
        <tr>
            <td>{{ order.id }}</td>
            <td>{{ order.user.username }}</td>
            <td>{{ order.product.title }}</td>
            <td>{{ order.quantity }}</td>
            <td>{{ order.total_price }}</td>
            <td>{{ order.get_payment_method_display }}</td>
            <td>{{ order.get_payment_status_display }}</td>
            <td>{{ order.order_date }}</td>
            <td>
                <form method="POST" action="{% url 'update_payment_status' order.id %}">
                    {% csrf_token %}
                    <select name="payment_status">
                        <option value="pending" {% if order.payment_status == "pending" %}selected{% endif %}>
                            입금 전
                        </option>
                        <option value="completed" {% if order.payment_status == "completed" %}selected{% endif %}>
                            입금 완료
                        </option>
                    </select>
                    <button type="submit">업데이트</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
